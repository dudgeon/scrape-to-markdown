<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./popup.css">
</head>
<body>
  <div class="container">
    <h1>s2md</h1>

    <div id="status" class="status">Connecting...</div>

    <div id="controls" class="controls hidden">
      <div class="field">
        <span class="label">Channel:</span>
        <span id="channel-name" class="channel-name">--</span>
      </div>

      <!-- Scope selector -->
      <div class="field">
        <label class="label">Export scope:</label>
        <div class="radio-group">
          <label><input type="radio" name="scope" value="last_n" checked> Last N messages</label>
          <label><input type="radio" name="scope" value="date_range"> Date range</label>
          <label><input type="radio" name="scope" value="all"> All messages</label>
        </div>
      </div>

      <div id="last-n-options" class="field">
        <label for="message-count">Messages:</label>
        <select id="message-count">
          <option value="25">25</option>
          <option value="50" selected>50</option>
          <option value="100">100</option>
          <option value="200">200</option>
          <option value="500">500</option>
        </select>
      </div>

      <div id="date-range-options" class="field hidden">
        <label>From: <input type="date" id="date-from"></label>
        <label>To: <input type="date" id="date-to"></label>
      </div>

      <!-- Options -->
      <div class="field options">
        <label><input type="checkbox" id="include-threads"> Include thread replies</label>
        <label><input type="checkbox" id="include-reactions" checked> Include reactions</label>
        <label><input type="checkbox" id="include-files" checked> Include file references</label>
        <label><input type="checkbox" id="include-frontmatter"> Include YAML frontmatter <a href="#" id="frontmatter-settings" class="settings-link" title="Frontmatter settings">&#9881;</a></label>
      </div>

      <!-- Progress -->
      <div id="progress" class="progress hidden">
        <div class="progress-bar"><div id="progress-fill" class="progress-fill"></div></div>
        <span id="progress-text" class="progress-text">Fetching...</span>
      </div>

      <!-- Actions -->
      <div class="actions">
        <button id="copy-btn" class="btn btn-primary">Copy as Markdown</button>
        <button id="download-btn" class="btn btn-secondary">Download .md</button>
      </div>

      <div id="result" class="result hidden">
        <span id="result-message"></span>
      </div>
    </div>

    <!-- Web clip mode (non-Slack pages) -->
    <div id="clip-controls" class="controls hidden">
      <div class="field">
        <span class="label">Page:</span>
        <span id="clip-page-title" class="page-title">--</span>
      </div>

      <div class="field options">
        <label><input type="checkbox" id="clip-include-frontmatter"> Include YAML frontmatter <a href="#" id="clip-frontmatter-settings" class="settings-link" title="Frontmatter settings">&#9881;</a></label>
      </div>

      <div id="clip-progress" class="progress hidden">
        <div class="progress-bar"><div id="clip-progress-fill" class="progress-fill"></div></div>
        <span id="clip-progress-text" class="progress-text">Extracting...</span>
      </div>

      <div class="actions">
        <button id="clip-copy-btn" class="btn btn-primary">Clip as Markdown</button>
        <button id="clip-download-btn" class="btn btn-secondary">Download .md</button>
      </div>

      <div id="clip-result" class="result hidden">
        <span id="clip-result-message"></span>
      </div>
    </div>

    <div id="error" class="error hidden"></div>

    <footer class="version"></footer>
  </div>
  <script type="module" src="./popup.ts"></script>
</body>
</html>
